def formatar_tempo(segundos):
    """Formata segundos em HH:MM:SS."""
    horas = int(segundos // 3600)
    minutos = int((segundos % 3600) // 60)
    seg = int(segundos % 60)
    return f"{horas:02d}:{minutos:02d}:{seg:02d}"

def calcular_tempo_restante(total_processadas, total_a_processar, lista_tempos):
    """Calcula o tempo restante estimado baseado na média dos tempos de processamento."""
    if total_processadas > 0 and total_a_processar > total_processadas:
        if lista_tempos: # Certifica-se que a lista não está vazia
            media_tempo = sum(lista_tempos) / len(lista_tempos)
            restantes = total_a_processar - total_processadas
            tempo_restante_segundos = restantes * media_tempo
            return formatar_tempo(tempo_restante_segundos)
    return "Calculando..."

outra coisa que e de EXTREMA IMPORTANCIA a macro fez o processo de extrai uma os, mas apos extrai uma os ela fechou a macro falando que tinha processado todoas como no arquivo tem 2573 ela disse que tinha processado todas sendo que processou so uma como pode ver no log 2025-05-13 11:35:57,151 - INFO - Começo da operação: 11:35 -- 13/05
2025-05-13 11:35:57,152 - INFO - Termino da operação: 11:35 -- 13/05
2025-05-13 11:35:57,152 - INFO - Total de OS processadas (2573)
2025-05-13 11:35:57,152 - INFO - Tempo total da operação: 11 segundos 