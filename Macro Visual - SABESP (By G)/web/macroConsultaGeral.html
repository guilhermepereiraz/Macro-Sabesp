<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macro JGL - Macro Consulta Geral</title>
    <link rel="stylesheet" href="css/macroconsultagelra.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="shortcut icon" href="imagens/favicon_sabesp55.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/botao_fixo.css">
    <script src="js/botao_fixo.js"></script>
    <script type="text/javascript" src="eel.js"></script>
    <script type="text/javascript" src="js/macroconsultageral.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
</head>

<body>

    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo-block">
                    <img src="imagens/logo-sabesp-1024.png" alt="Logo Macro JGL">
                    <div class="logo-text">Macro JGL</div>
                </div>
                <span style="margin-left: 24%;"></span>

                <nav class="main-nav">
                    <ul>
                        <li><a href="index.html">Inicio</a></li>
                        <li><a href="macros.html" style="text-decoration: underline; color: rgb(12, 38, 53);">Macros</a>
                        </li>
                        <li><a href="#">Consultas</a></li>
                        <li><a href="#">Ajuda</a></li>
                        <li><a href="#">Sugestão</a></li>
                        <li><a href="configuracoes.html">Configurações</a></li>
                        <li><a href="#">Sobre</a></li>
                    </ul>
                </nav>
                <span style="margin-left: 10%;"></span>
                <div class="user-actions-group">
                    <div class="user-info">
                        <div class="user-status-block">
                            <i class="fas fa-user icon-user"></i>
                            <div class="user-status-text">
                                <span style="font-size: 1.2em; font-weight: 600;" id="nome-usuario">Nome do
                                    Usuário</span>
                                <span style="margin-top: 1px;">Usuário ativo</span>
                            </div>
                        </div>
                        <div class="user-time-block">
                            <i class="fas fa-clock icon-clock"></i>
                            <div class="time-info-text">
                                <span id="current-time" style="font-size: 1.2em; font-weight: 600;">Horario Atual</span>
                                <span id="logged-in-time" style="margin-top: 1px;">Horario Logado</span>
                            </div>
                        </div>
                    </div>
                    <button class="logout-button-styled" style="width: 100px; height: 40px; margin-left: 35px;"
                        onclick="deslogar()" id="deslog">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <section id="macrosite-section">
            <h2 style="font-size: 2em; border-bottom: 2px solid #0056b3; margin-top: 5%;">Macro Consulta Geral - NETA</h2>
            <i class="fas fa-info-circle icon" id="iconeduvida"
                style="color: rgb(5, 110, 248); font-size: 1.5em; margin-bottom: 1%; cursor: pointer; width: 100%;"
                title="Dicas de Funcionamento" onclick="chamarDuvida()"> Dicas de Uso</i>
            <div id="duvida-site" style="display: none;">
                <p>Bem-vindo(a) à Macro de Consulta Geral - NETA. Esta ferramenta foi desenvolvida para otimizar a
                    obtenção
                    de informações diretamente do site NETA, automatizando o processo de busca e coleta de dados.</p>
                <p>Para a execução desta macro, siga os passos abaixo:</p>
                <p>1 - Prepare seu arquivo: É necessário fornecer um documento nos formatos Excel (.xlsx, .xls) ou CSV
                    (.csv).</p>
                <p>2 - Certifique-se do conteúdo: O arquivo deve conter uma coluna essencial com o cabeçalho
                    <strong>PDE</strong> ou <strong>HIDROMETRO</strong>. Esta coluna deve listar todos os números de
                    PDE ou HIDRO para os quais você deseja buscar informações no site NETA.
                </p>
                <p>Ao final do processamento, uma pasta chamada
                    <strong>[Macro JGL - Macro SITE]</strong> será criada na sua Área de Trabalho, contendo o arquivo
                    com os resultados.
                </p>
                <p>Resultados Obtidos: Fornecimento, PDE|HIDRO, Tipo Mercado, Status Fornecimento, Titular, Tipo
                    Sujeito, Celular, Endereço Fornecimento, Tipo Fornecimento, Oferta/Produto, Entrega Fatura, Condição
                    de Pagamento, Modo de Envio, Grupo Faturamento, Data Proxima Leitura, Numero de Residencias, Status
                    Atual, ATC, Tipo de Cavalete, Data de Ligação Agua, Diâmetro, SITIA, Status SITIA, Data de Ligação
                    Esgoto, SITIE, Status SITIE.</p>
            </div>

            <div id="site-preview" style="display: block;">
                <h1>DEMOSTRATIVO</h1>
                <p>Ao iniciar a macro, os resultado visual serão parecidos com esses.</p>
                <p>Processando PDE|HIDRO: 256489465</p>
                <p>PDE|HIDRO Processadas: 900 de 2000</p>
                <p>PDE|HIDRO Não Processadas: 5</p>
                <p>Tempo Estimado: 01:50:30</p>
                <p>Porcentagem Concluída: 49%</p>
            </div>

            <p id="macrosite-error-message" class="error-message" style="display: none; color: red;"></p>

            <div class="form-container" id="macrosite-form" style="display: block;">
                <div class="input-group">
                    <label for="site-login">Login (NETA):</label>
                    <input type="text" id="site-login" placeholder="Digite o login do NETA">
                </div>
                <div class="input-group">
                    <label for="site-password">Senha (NETA):</label>
                    <input type="password" id="site-password" placeholder="Digite o login do NETA">
                </div>
                <div class="input-group">
                    <label>Tipo de Arquivo:</label>
                    <div class="radio-group">
                        <label for="csvOption">CSV</label>
                        <input type="radio" id="csvOption" checked name="arquivoTipo" value="csv"
                            style="margin-left: -0.5%; margin-top: -0.3%;">

                        <label for="excelOption">Excel</label>
                        <input type="radio" name="arquivoTipo" id="excelOption" value="excel"
                            style="margin-left: -0.5%; margin-top: -0.3%;">
                    </div>

                    <div class="input-pesquisa" style="margin-top: 0.5%; margin-bottom: 0.5%;">
                        <label>Tipo de Pesquisa:</label>
                        <div class="radio-group">
                            <label for="pdeOption">PDE</label>
                            <input type="radio" id="pdeOption" checked name="pesquisaTipo" value="pde"
                                style="margin-left: -0.5%; margin-top: -0.3%;">

                            <label for="hidroOption">HIDRO</label>
                            <input type="radio" name="pesquisaTipo" id="hidroOption" value="hidro"
                                style="margin-left: -0.5%; margin-top: -0.3%;">
                        </div>
                    </div>
                    <div class="input-group file-input-group">
                        <label for="arquivo-csv">Selecionar Arquivo:</label> <input type="file" id="arquivo-csv">
                        <span class="file-name" id="selected-file-name"></span>
                    </div>

                    <button id="processar">Iniciar</button>

                </div>
            </div>

            <div id="macrosite-processing-status" style="display: none;">
                <h3 style="font-weight: bolder; font-size: 1.8em;">Status do Processamento:</h3>
                <h1 class="ml7">
                    <span class="text-wrapper">
                        <span class="letters">Executando</span>
                    </span>
                </h1>
                <div class="spinner">
                    <div class="rect1"></div>
                    <div class="rect2"></div>
                    <div class="rect3"></div>
                    <div class="rect4"></div>
                    <div class="rect5"></div>
                </div>
                <div class="status-info" style="font-size: 1.2em; margin-top: 3%;">
                    <p>Processando PDE|HIDROS: <span id="os-processando">- Calculando..</span></p>
                    <p>PDE|HIDROS Processados: <span id="quantidade">- Calculando..</span><span id="total-count"></span></p>
                    <p>PDE|HIDROS com Erros: <span id="oserros">- Calculando..</span></p>
                    <p>Tempo Estimado: <span id="tempoestimado">- Calculando..</span></p>
                    <p>Porcentagem Concluída: <span id="porcentagem-concluida">- Calculando..</span></p>
                </div>
                <div id="processing-log">
                    <h4>Log de Atividade:</h4>
                    <div class="log-messages">
                        <p>Processamento iniciado...</p>
                    </div>
                </div>
                <div id="recent-errors">
                    <h4>Erros Recentes:</h4>
                    <ul class="error-list">
                        <li class="no-errors">Nenhum erro até o momento.</li>
                    </ul>
                </div>


                <div id="contextual-tips">
                    <h4>Dicas Rápidas:</h4>
                    <div class="tip-text">
                        <p id="dicasaqui">Prepare seu arquivo com antecedência para agilizar o processo.</p>
                    </div>
                </div>
<!-- 
                <button id="pausar" class="styled-button" onclick="pausarMacro()">Pausar</button>
                <button id="encerrar" class="styled-button" onclick="encerrarMacro()">Encerrar</button> -->
            </div>
            <div id="transps"></div>
            <div id="Divencerrar" style="display: none;">
                <h1 style="color: rgb(163, 6, 6); font-weight: bolder;">ATENÇÃO!</h1>
                <p>Deseja realmente encerrar o processamento da
                    macro?</p>
                <p>Todas as operações em andamento serão
                    interrompidas,</p>
                <p>podendo gerar resultados incompletos.</p>
                <button id="sim" onclick="mostrarEncerramentoFinal()">Sim</button>
                <button id="nao" onclick="NaoEncerrandoMacro()">Não</button>
            </div>

            <div id="Divpausar" style="display: block;">
                <h1 style="color: #f8aa00; font-weight: bolder;">ATENÇÃO!</h1>
                <p>Deseja pausar o processamento da macro?</p>
                <p>A execução será temporariamente interrompida.</p>
                <p>Você poderá continuar de onde parou a qualquer momento.</p>
                <button id="sim2" onclick="efetuarPausaMacro()">Sim</button>
                <button id="nao2" onclick="NaoPausarMacro()">Não</button>
            </div>

            <div id="DivencerrarFinal" style="display: none;">
                <h1 style="color: #0056b3; font-weight: bolder;">CONSULTA GERAL - NETA</h1>
                <p>Macro encerrada com sucesso</p>
                <p>Clique em "OK" para
                    continuar..</p>
                <button id="ok" onclick="fecharEncerramentoFinal()">Ok</button>
            </div>

            <div id="macrosite-completion-status" class="completion-section" style="display: none;">
                <h2>Processamento Concluído</h2>
                <div class="status-item">
                    <i class="fas fa-calendar-alt"></i><span class="status-label">Início:</span> <span
                        id="start-datetime">17/05/2025 às 14:30:00</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-calendar-check"></i><span class="status-label">Término:</span> <span
                        id="end-datetime">17/05/2025 às 15:45:30</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-check-circle"></i><span class="status-label">PDE|HIDROS Processados:</span> <span
                        id="processed-count">1995</span>
                </div>
                <div class="status-item error">
                    <i class="fas fa-times-circle"></i><span class="status-label">Erros Encontrados:</span> <span
                        id="error-count">5</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-hourglass-half"></i><span class="status-label">Tempo Total:</span> <span
                        id="total-time">01h 15m 30s</span>
                </div>

                <div class="percentage-bar-container">
                    <div class="percentage-bar" style="padding-top: 20px; margin-top: -5px;">100% Concluído</div>
                </div>

                <div class="action-buttons">
                    <button onclick="startNewMacro()">Iniciar Nova Consulta</button>
                    <button onclick="viewResultsFolder()">Ver Pasta de Resultados</button>
                    <div class="suggestions-section">
                        <h3>O que fazer agora?</h3>
                        <ul class="suggestion-list">
                            <li>
                                <i class="fas fa-file-excel"></i>
                                Analise o arquivo gerado na pasta de resultados para verificar os dados.
                            </li>
                            <li>
                                <i class="fas fa-lightbulb"></i>
                                Tem alguma sugestão para melhorar esta macro? <a href="#"
                                    onclick="showSuggestionForm()"> Envie sua ideia.</a>
                            </li>
                            <li>
                                <i class="fas fa-question-circle"></i>
                                Precisa de ajuda ou encontrou algum problema? <a href="#" onclick="abrirDuvida()">Fale
                                    com o suporte.</a>
                            </li>
                        </ul>

                        <div id="suggestion-form"
                            style="display: none; margin-top: 20px; text-align: left; background-color: #e9f5ff; padding: 20px; border-radius: 8px;">
                            <h4>Envie sua Sugestão</h4>
                            <textarea id="user-suggestion" rows="4" placeholder="Descreva sua sugestão aqui..."
                                style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; margin-bottom: 10px;"></textarea>
                            <button onclick="submitSuggestion()" class="styled-button"
                                style="background-color: #28a745;">Enviar Sugestão</button>
                            <button onclick="hideSuggestionForm()" class="styled-button"
                                style="background-color: #6c757d;">Cancelar</button>
                            <p id="suggestion-message" style="margin-top: 10px; font-weight: bold;"></p>
                        </div>
                    </div>
                </div>

        </section>

    </main>

    <div id="transp"></div>
    <div class="fab-button" id="fixedButton" onclick="abrirDuvida()">
        <i class="fas fa-headset icon"></i>
    </div>
    <div class="fixed-button-container">
        <div id="overlayText">
            <h1 style="font-size: 1.5em; text-align: center; font-weight: bolder; color: #2b8adf;">Ei! Como posso te
                ajudar?</h1>
            <hr>
            <div class="btfixoligue">
                <a href="#">
                    <i class="fas fa-robot"
                        style="position: absolute; font-size: 2.5em; margin-top: 4%; margin-left: 4%;"></i>
                    <h1 class="fixoligue">Assistente Virtual</h1>
                    <p class="fixoligue2">Clique para conversar com o suporte virtual.</p>
                </a>
            </div>
            <div class="btfixowpp">
                <a href="#" onclick="mostrarTawkTo(); return false;">
                    <i class="fas fa-users"
                        style="position: absolute; font-size: 2.5em; margin-top: 4%; margin-left: 4%;"></i>
                    <h1 class="fixowpp1">Fale com Nossa Equipe</h1>
                    <p class="fixowpp2">Clique para iniciar uma conversa com um atendente</p>
                </a>
            </div>
        </div>
    </div>
</body>

</html>